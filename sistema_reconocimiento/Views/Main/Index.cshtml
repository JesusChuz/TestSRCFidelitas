<<<<<<< HEAD
﻿@model sistema_reconocimiento.Models.SubmitPurchaseViewModel

@{

    ViewData["Title"] = "Principal";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int points = ViewBag.GetPoints;
    int ID_Engineer = ViewBag.GetIdEngineer;
=======
﻿@{

    ViewData["Title"] = "Principal";
    Layout = "~/Views/Shared/_Layout.cshtml";
>>>>>>> 5214b57e3f10b832105456c72dacff5b1de60d2b
}

<!-------------rest of the page ------------->
<div class="app-content content">
    <div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="content-header row"></div>
    <div class="content-body">
        <div class="row match-height">
            <div class="col-12">
                <div class="navbar-nav align-items-center">
                    <h3 class="content-header-right">@TempData["p"]"Ninguno de nosotros es tan bueno como todos nosotros juntos." -Ray Kroc.</h3>
                    </br>
                </div>
                </br>
                </br>
                </br>
            </div>
        </div>
    </div>
</div>
<!--/ eCommerce statistic -->
<!-- Statistics -->
<div class="row match-height">
    <div class="col-xl-4 col-lg-12">
    </div>
    <div class="col-xl-4 col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title">Top 5 ingenieros con mas reconocimientos</h4>
                <a class="heading-elements-toggle">
                    <i class="fa fa-ellipsis-v font-medium-3"></i>
                </a>
                <div class="heading-elements">
                    <ul class="list-inline mb-0">
                        <li>
                            <a data-action="reload">
                                <i class="ft-rotate-cw"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card-content">
                <div id="recent-buyers" class="media-list">
                    <a href="#" class="media border-0">
                        <div class="media-left pr-1">
                            <span class="avatar avatar-md avatar-online">
                                <img class="media-object rounded-circle" src="~/theme-assets/images/portrait/small/avatar-s-7.png" alt="Generic placeholder image">
                                <i></i>
                            </span>
                        </div>
                        <div class="media-body w-100">
                            <span class="list-group-item-heading">Kristopher Candy
                            </span>
                            <p class="list-group-item-text mb-0">
                                <span class="blue-grey lighten-2 font-small-3"></i> Support Engineer S3</span>
                            </p>
                        </div>
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </a>
                    <a href="#" class="media border-0">
                        <div class="media-left pr-1">
                            <span class="avatar avatar-md avatar-away">
                                <img class="media-object rounded-circle" src="~/theme-assets/images/portrait/small/avatar-s-8.png" alt="Generic placeholder image">
                            </span>
                        </div>
                        <div class="media-body w-100">
                            <span class="list-group-item-heading">Lawrence Fowler</span>
                            <p class="list-group-item-text mb-0">
                                <span class="blue-grey lighten-2 font-small-3"></i> Support Engineer S3</span>
                            </p>
                        </div>
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </a>
                    <a href="#" class="media border-0">
                        <div class="media-left pr-1">
                            <span class="avatar avatar-md avatar-busy">
                                <img class="media-object rounded-circle" src="~/theme-assets/images/portrait/small/avatar-s-9.png" alt="Generic placeholder image">
                                <i></i>
                            </span>
                        </div>
                        <div class="media-body w-100">
                            <span class="list-group-item-heading">Linda Olson</span>
                            <p class="list-group-item-text mb-0">
                                <span class="blue-grey lighten-2 font-small-3"></i> Technical Lead</span>                                    
                            </p>
                        </div>
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </a>
                    <a href="#" class="media border-0">
                        <div class="media-left pr-1">
                            <span class="avatar avatar-md avatar-online">
                                <img class="media-object rounded-circle" src="~/theme-assets/images/portrait/small/avatar-s-10.png" alt="Generic placeholder image">
                                <i></i>
                            </span>
                        </div>
                        <div class="media-body w-100">
                            <span class="list-group-item-heading">Roy Clark</span>
                            <p class="list-group-item-text mb-0">
                                <span class="blue-grey lighten-2 font-small-3"> Technical Lead </span>
                            </p>
                        </div>
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </a>
                    <a href="#" class="media border-0">
                        <div class="media-left pr-1">
                            <span class="avatar avatar-md avatar-online">
                                <img class="media-object rounded-circle" src="~/theme-assets/images/portrait/small/avatar-s-11.png" alt="Generic placeholder image">
                                <i></i>
                            </span>
                        </div>
                        <div class="media-body w-100">
                            <span class="list-group-item-heading">Kristopher Candy</span>
                            <p class="list-group-item-text mb-0">
                                <span class="blue-grey lighten-2 font-small-3">Subject Matter Expert</span>
                            </p>
                        </div>
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-4 col-lg-12">
    </div>

<!--/ Statistics -->
    <!-- Images -->
    <div class="card-header">
        <div class="navbar-nav align-items-center">
            <h3 class="content-header-right">Recompensas</h3>
            </br>
        </div>
        <div class="row mb-5">
             @foreach (var item in Model.Rewards)
            {
            <div class="col-md-6 col-xl-4">
                <div class="card mb-3">
                            <img class="card-img-top" src="@Url.Action("ShowPicture", "Main", new { id = item.ID_Reward })" width="350" height="450" />
                <div class="card-body">
                    <h5 class="card-title">
                       @Html.DisplayFor(modelItem => item.Reward_Name)
                    </h5>
                    <p class="card-text">
                      @Html.DisplayFor(modelItem => item.Reward_Description)
                    </p>
                    <label>
                      Precio:
                    </label>
                    <svg width="50" height="50">
                        <circle cx="25" cy="25" r="20" fill="#79d4f7" />
                        <text x="50%" y="60%" text-anchor="middle" fill="white" font-size="16px">@Html.DisplayFor(modelItem => item.Price)</text>
                    </svg>
                    <!-- <div class="navbar-nav align-items-center">
                        <a class="btn btn-danger" href="">Canjear puntos</a>
                    </div> -->
                        @using (Html.BeginForm("Canjear_Recompensa", "Main", FormMethod.Post, new { @class = "submit-purchase", role = "form" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                            <div class="mb-3">
                                        <input asp-for="Purchases.Engineer_ID" class="form-control disabled" value="@ID_Engineer" />
                                        <input asp-for="Purchases.Reward_ID" class="form-control txtID_Reward disabled" value="@item.ID_Reward" />
                                        <input asp-for="Purchases.Reward_Price" class="form-control txtPrice disabled" value="@item.Price" />
                                        <input asp-for="Purchases.Points" class="form-control txtPoints disabled" value="@points" />
                            </div>
                            <div class="navbar-nav align-items-center">
                                <button type="submit" class="btn btn-danger"> Buy </button>
                            </div>
                        }
                     </div>
                </div>
            </div>
            }
        </div>
    </div>
    <!--/ Images -->
</div>
</div>
<!-------------rest of the page ------------->
<script src="~/theme-assets/vendors/libs/jquery/jquery.js"></script>
<script>
    $(document).ready(function () {
        $('.submit-purchase').click(function (e) {
            e.preventDefault(); // Evita que el formulario se envíe automáticamente

            var form = $(this).closest('form');
            let points = parseInt(form.find('.txtPoints').val());
            let price = parseInt(form.find('.txtPrice').val());

            if (!isNaN(points) && !isNaN(price) && points >= price) {
                Swal.fire({
                    title: 'Are you sure that you want to buy this reward?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#79d4f7',
                    cancelButtonColor: 'red',
                    confirmButtonText: 'Yes, get this reward',
                    cancelButtonText: 'No, cancel'
                }).then((result) => {
                    if (result.isConfirmed) {
                        form.submit(); // Envía el formulario más cercano al botón clickeado
                    }
                });
            } else {
                Swal.fire({
                    title: 'Insufficient funds',
                    text: 'You do not have enough money to purchase this reward.',
                    icon: 'info',
                    confirmButtonColor: '#79d4f7',
                    confirmButtonText: 'OK'
                });
            }
        });
    });
</script>

